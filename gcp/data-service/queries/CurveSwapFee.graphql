query CurveSwapFee($poolId: String, $ts: Int) {
  liquidityPoolDailySnapshots(
    first: 1
    orderBy: timestamp
    orderDirection: desc
    where: {timestamp_lte: $ts, pool_: {id: $poolId}}
  ) {
    dailyProtocolSideRevenueUSD
  }
}